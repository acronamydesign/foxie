var fs = require("fs"),
		promise = require("bluebird"),
		data = require("foxie-data"),
		api = require("foxie-api")
		api = {
			foxieDir:api.path.mainPath
		}

var bowerrc = {
	directory: data.public.libraries.replace(api.foxieDir("server"),""),
	analytics: false,
	timeout: 120000
}

promise.promisifyAll(fs)


function mkLibsDir(__path){
	fs.mkdirAsync(__path)
	.catch(function(err){
		if(err) console.log(err)
	})
	fs.writeFileAsync(__path+"/overides.json","utf8")
	.catch(function(err){
		if(err) console.log(err)
	})
}
function writeBowerrc(__path){
	fs.writeFileAsync(__path,JSON.stringify(bowerrc,null,"\t"),"utf8")
}

fs.readdirAsync(data.public.libraries)
.then(function(){
	require("./controllers/watchLibsDir.js")(data.public.libraries)
})
.catch(function(err){
	if(err) mkLibsDir(data.public.libraries)
})


fs.readFileAsync(api.foxieDir("server")+"/.bowerrc")
.catch(function(err){
	if(err) writeBowerrc(api.foxieDir("server")+"/.bowerrc")
})
