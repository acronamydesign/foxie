var mongoose = require("foxie-mongoose"),
	api = require("foxie-api"),
	api = {
		machineName: api.misc.machineName,
		loadModel: api.connection.loadModel,
		queryGate: api.connection.queryGate
	}

var schema = {
	boxes: api.loadModel("foxie-boxes", "boxes.model.js")
}

module.exports = function (boxes, themeName) {

	api.queryGate(schema.boxes, function () {


		for (item in boxes) {
			var allBoxes = boxes[item]

			for (box in allBoxes) {

				var saveObj = {
					theme: api.machineName(themeName),
					machineName: api.machineName(box),
					name: allBoxes[box].name,
					wrapper: allBoxes[box].wrapper,
					classes: allBoxes[box].classes,
					compiled: allBoxes[box].compile,
					mixin: allBoxes[box].mixin || ""
				}

				var box = new schema.boxes(saveObj)
				box.save(function (err) {
					if (err) console.log(err)
				})
			}
		}
		console.log("end loop\n")

	})
}
