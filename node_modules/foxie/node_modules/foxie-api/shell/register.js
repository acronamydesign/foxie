parseMeta = require("./actions/parseMeta.js"),
	fs = require("fs"),
	path = require("path")


//Code drunk refactor later
function jsonReg(str){
	fs.writeFile(path.normalize(__dirname+"/register.json"),str,function(err){
		if(err) console.log(err)
	})
}

var methodPath = __dirname+"/methods";
fs.readdir(path.normalize(methodPath),function(err,result){
	if(err) console.log(err)
	var obj = {}
	for(methodName in result){
		obj[result[methodName]] = {}
		obj[result[methodName]]["json"] = "./methods/"+result[methodName]+"/meta.json"
	}
	jsonReg(JSON.stringify(obj,null,"\t"))
})


//SYNC
var jsonRegister = require("./register.json");

var $ = {}

for(item in jsonRegister){
	var namespace = item;
	var commandPath = jsonRegister[item].json
	$[namespace] = parseMeta(commandPath)
}



module.exports = $;
