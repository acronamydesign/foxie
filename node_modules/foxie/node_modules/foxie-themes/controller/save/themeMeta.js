var path = require("path"),
		data = require("foxie-data"),
		api = require("foxie-api"),
		mongoose = require("foxie-mongoose")
		api = {
			loadModel:api.connection.loadModel,
			queryGate:api.connection.queryGate,
			installed:api.misc.installStat,
			machineName: api.misc.machineName
		}

var schema = {
	themes:api.loadModel("foxie-themes","themes.model.js"),
}

module.exports = function(){

	api.queryGate(schema.themes,function(){ //require the file to build theme meta
			var readyThemes = data.themes.ready
			for(theme in readyThemes){
				var themeJson = data.public.themes+"/"+readyThemes[theme]+"/package.json"
				var themeJson = require(themeJson);

				var saveObj = {
					machineName:api.machineName(themeJson.name),
					name:themeJson.name,
					version:themeJson.version,
					description:themeJson.description,
					author:themeJson.author,
					license:themeJson.license
				}
				console.log(saveObj)

				var themes = new schema.themes(saveObj)
				themes.save(function(err){
					if(err) console.log(err)
				})

			}
		})

}
