var data = require("foxie-data")

module.exports = function(themesTemplate,systemTemplate,themeName){

	//select the template based on the global app settings
	var templateLangSet = data.themes.engine;

	var themesTemplate = themesTemplate[templateLangSet]

	var tmpArr = []
	for(t in systemTemplate){
		for(item in systemTemplate[t]){
			tmpArr.push(systemTemplate[t][item])
		}
	}

	var systemTemplate = tmpArr;

	for(sFile in systemTemplate){

		var sysFilePath = systemTemplate[sFile],
				sysFile = sysFilePath.split("/").pop()

		for(tFile in themesTemplate){
			var themeFilePath = themesTemplate[tFile],
				themeFile = themeFilePath.split("/").pop()
					if(themeFile == sysFile) sysFilePath = themeFilePath
		}
		systemTemplate[sFile] = sysFilePath //make changes
	}

	var themeObj = {}

	themeObj[themeName] = systemTemplate

	//start to compile and concat the templates
	require("../compile/templates.js")(themeObj,themeName)
}
